<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Contact Us | AVIMS Vehicle Insurance</title>

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>

    <!-- Fonts (keep the newer, escaped version) -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@300;400;500;600;700&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#0a1e3e",
                        "electric-blue": "#00D0FF",
                        "background-light": "#fcfcfd",
                        "background-dark": "#0a1529",
                    },
                    fontFamily: {
                        "display": ["Manrope", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>

    <style>
        .bento-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .bento-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px -5px rgba(10, 30, 62, 0.1), 0 8px 10px -6px rgba(10, 30, 62, 0.1);
        }
    </style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-primary dark:text-white min-h-screen">
    <div id="header-container"></div>

    <main class="max-w-[1400px] mx-auto px-6 lg:px-20 py-12 pt-8">
        <!-- Hero Title Section -->
        <div class="mb-16">
            <h1 class="text-5xl lg:text-7xl font-800 tracking-tight leading-[1.1] mb-6">
                Let's protect <br /><span class="text-electric-blue">what moves you.</span>
            </h1>
            <p class="text-lg text-primary/60 dark:text-white/60 max-w-2xl">
                Our specialists are available across the UK to provide expert guidance on your vehicle insurance. Reach
                out to a branch or send us a message below.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
            <!-- Left Column: Branch Cards -->
            <div class="lg:col-span-7 flex flex-col gap-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-2xl font-bold flex items-center gap-2">
                        <span class="material-symbols-outlined text-electric-blue">location_on</span>
                        Our Branches
                    </h3>
                    <button class="text-sm font-bold text-electric-blue hover:underline" type="button">View on map</button>
                </div>

                <!-- London Card -->
                <div
                    class="bento-card bg-white dark:bg-primary/20 border border-primary/5 dark:border-white/5 rounded-xl p-8 flex flex-col md:flex-row gap-8 items-start">
                    <div class="w-full md:w-48 aspect-square rounded-lg bg-cover bg-center shrink-0"
                        data-alt="Aerial view of London financial district"
                        style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuD57utJBx-e5MPUAfMbD7dWXU3FBKg4meSIYhAvZ46XlnDcf77OUMEULLaBtSn0P8P2oAKxbfKEcW0GKTxFH13cluuXEhn6XZI6q5rfyiK1d1eYzhwY_tHmjWo0y91UNSoYCwp7jWXQjTgs0FUevgiHe-mmBlKrH8gJ6x4r3gV5qIzDTKxWqG-V3E14X9vs-HOzY85qoJ4MA6KEfaWwFBnw42nFLM2bBHWvapMG3q8pajdqmclYXzVKW_92QLvDHTBOdBSmJW4Mwy5K");'>
                    </div>

                    <div class="flex-1">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h4 class="text-xl font-bold">London Head Office</h4>
                                <p class="text-sm text-electric-blue font-semibold">Sarah Jenkins — Branch Manager</p>
                            </div>
                            <span class="bg-primary/10 dark:bg-white/10 text-[10px] uppercase font-bold px-2 py-1 rounded">
                                Main Hub
                            </span>
                        </div>

                        <div class="space-y-3 text-sm text-primary/70 dark:text-white/70">
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-sm">map</span>
                                <span>123 Financial District, London, EC2V 7NQ</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-sm">call</span>
                                <span>+44 20 7123 4567</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="material-symbols-outlined text-sm">alternate_email</span>
                                <span>london@avims.com</span>
                            </div>
                        </div>

                        <a class="mt-6 inline-flex items-center gap-2 text-sm font-bold text-primary dark:text-white hover:text-electric-blue dark:hover:text-electric-blue transition-colors"
                            data-location="London" href="#">
                            Directions <span class="material-symbols-outlined text-sm">arrow_outward</span>
                        </a>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Manchester Card -->
                    <div class="bento-card bg-white dark:bg-primary/20 border border-primary/5 dark:border-white/5 rounded-xl p-6">
                        <div class="w-full aspect-video rounded-lg bg-cover bg-center mb-6"
                            data-alt="Manchester city center skyline"
                            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuB5wyjBfQCn0Laz0CMWZFCs5EKEr7iko4_khFuqjJ-3KXqig1W9Dmb0RN_foQhScwW6gsz4wDslFc8FHhEhWxCGO1BSFv0b2exK9z91cEeWIbWjSEGToIHZTnuGw6L_zOFXhE5pCVBqmDULiJLNifXUdKYiOzDk4Kn3P6Iaznqh4kG5VJDPaHSUJm6GOjX8pvL3Dv5fX2M1-2z_SOQD_qJJEoekayNqgPUTGYweLiAmIATaShBgc7ZMROpX4ZuOEuAg897XvIzlpsyY");'>
                        </div>
                        <h4 class="text-lg font-bold mb-1">Manchester Branch</h4>
                        <p class="text-xs text-electric-blue font-semibold mb-4">Mark Thompson — Manager</p>
                        <div class="space-y-2 text-xs text-primary/70 dark:text-white/70 mb-6">
                            <p class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs">map</span> 45 Deansgate, Manchester
                            </p>
                            <p class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs">call</span> +44 161 832 1234
                            </p>
                        </div>
                        <a class="text-xs font-bold flex items-center gap-1 hover:text-electric-blue"
                            data-location="Manchester" href="ContactUsDetail.html">
                            View Details <span class="material-symbols-outlined text-xs">chevron_right</span>
                        </a>
                    </div>

                    <!-- Birmingham Card -->
                    <div class="bento-card bg-white dark:bg-primary/20 border border-primary/5 dark:border-white/5 rounded-xl p-6">
                        <div class="w-full aspect-video rounded-lg bg-cover bg-center mb-6"
                            data-alt="Birmingham Colmore Row architecture"
                            style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBqukhuhVbxdfyObYPenZj9KKjUP8PUPJ58GkMFy2YA3apQiyCyFy9fBvSXsOoA3QavjPn4lcG1GeGXADRgMIiOegVGOim_qkZ_l7GK6Hj5FXRDBsWZmgIxKsCVPKvzk9S5YTxPQGQRHH1TpISMsEhz2RXQ8TzUommuPUBmqvM8B9nfZZYyCcWPHKqbWdc8OXumCT_az3MA6UfjNGFtAeJE_eRbph1QvdAXSbNZKPs6CYazF27Sz_BT74a-59_1iHaZgAOGF8Byyii6");'>
                        </div>
                        <h4 class="text-lg font-bold mb-1">Birmingham Branch</h4>
                        <p class="text-xs text-electric-blue font-semibold mb-4">Elena Rodriguez — Manager</p>
                        <div class="space-y-2 text-xs text-primary/70 dark:text-white/70 mb-6">
                            <p class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs">map</span> 88 Colmore Row, Birmingham
                            </p>
                            <p class="flex items-center gap-2">
                                <span class="material-symbols-outlined text-xs">call</span> +44 121 236 5678
                            </p>
                        </div>
                        <a class="text-xs font-bold flex items-center gap-1 hover:text-electric-blue"
                            data-location="Birmingham" href="ContactUsDetail.html">
                            View Details <span class="material-symbols-outlined text-xs">chevron_right</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Right Column: Contact Form -->
            <div class="lg:col-span-5">
                <div
                    class="sticky top-28 bg-white dark:bg-primary border border-primary/10 dark:border-white/10 rounded-2xl p-8 lg:p-10 shadow-2xl shadow-primary/5">

                    <div class="mb-8">
                        <h3 class="text-2xl font-bold mb-2">Send us a Message</h3>
                        <p class="text-sm text-primary/60 dark:text-white/60">Our team typically responds within 2
                            business hours.</p>
                    </div>

                    <!-- Notification -->
                    <div id="notification" class="hidden mb-5 text-sm px-4 py-3 rounded-lg"></div>

                    <form id="contactForm" class="space-y-5">
                        <div class="grid grid-cols-1 gap-5">
                            <div>
                                <label class="block text-xs font-bold uppercase tracking-wider mb-2 opacity-60">
                                    Full Name
                                </label>
                                <input id="name" required
                                    class="w-full bg-background-light dark:bg-background-dark/50 border-primary/10 dark:border-white/10 rounded-lg focus:ring-electric-blue focus:border-electric-blue px-4 py-3 outline-none transition-all"
                                    placeholder="John Doe" type="text" />
                            </div>

                            <div>
                                <label class="block text-xs font-bold uppercase tracking-wider mb-2 opacity-60">
                                    Email Address
                                </label>
                                <input id="email" required
                                    class="w-full bg-background-light dark:bg-background-dark/50 border-primary/10 dark:border-white/10 rounded-lg focus:ring-electric-blue focus:border-electric-blue px-4 py-3 outline-none transition-all"
                                    placeholder="john@example.com" type="email" />
                            </div>

                            <div>
                                <label class="block text-xs font-bold uppercase tracking-wider mb-2 opacity-60">
                                    Subject
                                </label>
                                <select id="subject"
                                    class="w-full bg-background-light dark:bg-background-dark/50 border-primary/10 dark:border-white/10 rounded-lg focus:ring-electric-blue focus:border-electric-blue px-4 py-3 outline-none transition-all">
                                    <option>General Inquiry</option>
                                    <option>New Quote</option>
                                    <option>Claim Support</option>
                                    <option>Policy Update</option>
                                    <option>Feedback</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-xs font-bold uppercase tracking-wider mb-2 opacity-60">
                                    Message
                                </label>
                                <textarea id="message" required
                                    class="w-full bg-background-light dark:bg-background-dark/50 border-primary/10 dark:border-white/10 rounded-lg focus:ring-electric-blue focus:border-electric-blue px-4 py-3 outline-none transition-all resize-none"
                                    placeholder="How can we help you today?" rows="5"></textarea>
                            </div>
                        </div>

                        <button
                            class="w-full bg-primary dark:bg-electric-blue text-white dark:text-primary py-4 rounded-lg font-800 tracking-wide hover:opacity-90 transition-all flex items-center justify-center gap-2 mt-4"
                            type="submit">
                            Send Message
                            <span class="material-symbols-outlined text-lg">send</span>
                        </button>
                    </form>

                    <div class="mt-8 pt-8 border-t border-primary/5 dark:border-white/5 grid grid-cols-2 gap-4 text-center">
                        <div>
                            <p class="text-[10px] font-bold uppercase opacity-40 mb-1">Support Hours</p>
                            <p class="text-xs font-semibold">Mon-Fri: 8am-8pm</p>
                        </div>
                        <div>
                            <p class="text-[10px] font-bold uppercase opacity-40 mb-1">Direct Line</p>
                            <p class="text-xs font-semibold">0800 123 4567</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </main>

    <!-- Footer from template -->
    <iframe id="footer-frame" src="../templates/footer.html"
        style="border: none; width: 100%; margin: 0; padding: 0; display: block; overflow: hidden;"
        frameborder="0"></iframe>

    <script>
        // Auto-adjust iframe heights
        function resizeIframe(iframe) {
            try {
                const height = iframe.contentWindow.document.documentElement.scrollHeight;
                iframe.style.height = height + 'px';
            } catch (err) {
                console.log('Cannot access iframe content');
            }
        }

        const footerFrame = document.getElementById('footer-frame');

        if (footerFrame) {
            footerFrame.onload = function () {
                resizeIframe(footerFrame);
            };
        }

        // Resize on window resize
        window.addEventListener('resize', function () {
            if (footerFrame) resizeIframe(footerFrame);
        });
    </script>

    <script>
        // Load header fragment
        fetch('../templates/header.html')
            .then(response => {
                console.log('Header fetch response:', response.status);
                return response.text();
            })
            .then(html => {
                console.log('Header HTML loaded, inserting into DOM');
                document.getElementById('header-container').innerHTML = html;
                
                // Load header.js script file
                const script = document.createElement('script');
                script.src = '../js/header.js';
                script.onload = () => {
                    console.log('header.js loaded successfully');
                    // Now check for initializeHeader
                    let retries = 0;
                    const checkAndInitialize = () => {
                        retries++;
                        if (window.headerScriptLoaded && window.initializeHeader && typeof window.initializeHeader === 'function') {
                            console.log('Calling window.initializeHeader()');
                            window.initializeHeader();
                        } else if (retries < 10) {
                            setTimeout(checkAndInitialize, 100);
                        }
                    };
                    checkAndInitialize();
                };
                script.onerror = () => {
                    console.error('Failed to load header.js');
                };
                document.head.appendChild(script);
            })
            .catch(error => console.error('Error loading header:', error));
    </script>

    <script>
        document.getElementById("contactForm").addEventListener("submit", async function (e) {
            e.preventDefault(); // Prevent reload

            // 1. Get form data
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const subject = document.getElementById("subject").value;
            const rawMessage = document.getElementById("message").value;

            // Combine subject into message
            const fullMessage = `[${subject}] ${rawMessage}`;

            const noti = document.getElementById("notification");
            const btn = document.querySelector("#contactForm button[type='submit']");

            // 2. Show sending state
            noti.classList.remove("hidden", "bg-green-100", "text-green-700", "bg-red-100", "text-red-700");
            noti.classList.add("bg-blue-100", "text-blue-700");
            noti.innerText = "⏳ Sending message...";
            btn.disabled = true;

            try {
                const response = await fetch("http://localhost:5169/api/Contacts", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        name: name,
                        email: email,
                        message: fullMessage
                    })
                });

                if (response.ok) {
                    noti.classList.remove("bg-blue-100", "text-blue-700");
                    noti.classList.add("bg-green-100", "text-green-700");
                    noti.innerText = "✅ Message sent successfully! We will contact you soon.";
                    document.getElementById("contactForm").reset();
                } else {
                    throw new Error("Server Error");
                }
            } catch (error) {
                console.error(error);
                noti.classList.remove("bg-blue-100", "text-blue-700");
                noti.classList.add("bg-red-100", "text-red-700");
                noti.innerText = "❌ Connection failed. Please check if the server is running.";
            } finally {
                btn.disabled = false;
            }
        });
    </script>
    <script src="../js/pageLoader.js"></script>

</body>

</html>

